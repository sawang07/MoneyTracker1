<!DOCTYPE html>
<html lang="th">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>‡πÅ‡∏≠‡∏û‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô</title>
  <link href="https://fonts.googleapis.com/css2?family=Sarabun&display=swap" rel="stylesheet" />
  <style>
    body {
      font-family: 'Sarabun', sans-serif;
      margin: 0;
      padding: 20px;
      background-color: #121212;
      color: #f0f0f0;
    }

    h2,
    h3,
    h4 {
      color: #e0e0e0;
    }

    .balance {
      font-size: 32px;
      font-weight: bold;
      margin-bottom: 10px;
    }

    .buttons {
      margin-bottom: 20px;
    }

    .buttons button {
      background-color: #1f1f1f;
      color: #fff;
      border: 1px solid #2d2d2d;
      border-radius: 8px;
      padding: 10px 20px;
      margin: 5px 5px 10px 0;
      font-size: 16px;
      cursor: pointer;
      transition: background-color 0.3s;
    }

    .buttons button:hover {
      background-color: #2a2a2a;
    }

    input[type="number"] {
      padding: 10px;
      font-size: 16px;
      width: 120px;
      border: none;
      border-radius: 6px;
      margin-right: 10px;
      background: #2b2b2b;
      color: #fff;
    }

    .log-entry {
      background: #1e1e1e;
      padding: 10px 15px;
      margin-bottom: 6px;
      border-radius: 6px;
    }

    .log-entry span {
      color: #888;
      margin-right: 6px;
    }

    .income {
      border-left: 4px solid #00c896;
      color: #b2f5dc;
    }

    .expense {
      border-left: 4px solid #ff5c5c;
      color: #ffcaca;
    }

    #summaryList {
      margin-top: 25px;
    }

    #summaryList p {
      margin: 4px 0;
      padding-left: 6px;
      border-left: 3px solid #00c896;
    }

    button:focus,
    input:focus {
      outline: none;
    }

    ::placeholder {
      color: #aaa;
    }

    hr {
      border: 0;
      height: 1px;
      background: #333;
      margin: 20px 0;
    }
  </style>
</head>

<body>
  <h2>üí≥ ‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠: <span id="balance"></span> ‡∏ö‡∏≤‡∏ó</h2>

  <div class="buttons">
    <button onclick="spend(20)">‡πÉ‡∏ä‡πâ 20</button>
    <button onclick="spend(50)">‡πÉ‡∏ä‡πâ 50</button>
    <button onclick="spend(100)">‡πÉ‡∏ä‡πâ 100</button>
    <button onclick="spend(500)">‡πÉ‡∏ä‡πâ 500</button>
    <br /><br />
    <input type="number" id="customAmount" placeholder="‡πÄ‡∏ä‡πà‡∏ô 150" />
    <button onclick="spendCustom()">‡πÉ‡∏ä‡πâ‡πÄ‡∏á‡∏¥‡∏ô</button>
    <button onclick="addCustom()">‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏á‡∏¥‡∏ô</button>
    <br /><br />
    <button onclick="resetBalance()">üîÑ ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô</button>
    <button onclick="exportData()">üì§ ‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
    <button onclick="importData()">üì• ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏Ñ‡∏∑‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
    <input type="file" id="fileInput" style="display:none" />
  </div>

  <hr />

  <h3>üìú ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</h3>
  <div id="logList"></div>

  <div id="summaryList"></div>

  <script>
    let balance = 1000;
    let logData = [];

    if (localStorage.getItem('moneyData')) {
      const saved = JSON.parse(localStorage.getItem('moneyData'));
      balance = saved.balance;
      logData = saved.logs;
    }

    function updateBalance() {
      document.getElementById('balance').textContent = balance.toLocaleString();
    }

    function saveData() {
      localStorage.setItem('moneyData', JSON.stringify({
        balance: balance,
        logs: logData
      }));
    }

    function log(text, amount) {
      const now = new Date();
      const time = now.toLocaleTimeString();
      const date = now.toISOString().split('T')[0];
      const entry = {text, time, date, amount};
      logData.unshift(entry);
      renderLogs();
      saveData();
    }

    function renderLogs() {
      const list = document.getElementById('logList');
      list.innerHTML = '';
      const summary = {};
      let totalIncome = 0, totalExpense = 0;

      logData.forEach(entry => {
        const div = document.createElement('div');
        div.className = 'log-entry ' + (entry.amount >= 0 ? 'income' : 'expense');
        div.innerHTML = `<span>[${entry.time}]</span> ${entry.text}`;
        list.appendChild(div);

        if (!summary[entry.date]) summary[entry.date] = 0;
        if (entry.amount < 0) summary[entry.date] += -entry.amount;

        if (entry.amount > 0) totalIncome += entry.amount;
        else totalExpense += -entry.amount;
      });

      const sumList = document.getElementById('summaryList');
      sumList.innerHTML = '<h4>üìÜ ‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏≠‡∏î‡πÉ‡∏ä‡πâ‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô</h4>';
      for (const date in summary) {
        const p = document.createElement('p');
        p.textContent = `${date}: ‡πÉ‡∏ä‡πâ‡πÑ‡∏õ ${summary[date].toLocaleString()} ‡∏ö‡∏≤‡∏ó`;
        sumList.appendChild(p);
      }

      sumList.innerHTML += `<p>üí∞ ‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö: ${totalIncome.toLocaleString()} ‡∏ö‡∏≤‡∏ó</p>`;
      sumList.innerHTML += `<p>üí∏ ‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢: ${totalExpense.toLocaleString()} ‡∏ö‡∏≤‡∏ó</p>`;
    }

    function spend(amt) {
      if (amt <= 0 || isNaN(amt)) return;
      if (amt > balance) return alert('‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡πÑ‡∏°‡πà‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠');
      balance -= amt;
      updateBalance();
      log(`‡πÉ‡∏ä‡πâ‡πÄ‡∏á‡∏¥‡∏ô ${amt} ‡∏ö‡∏≤‡∏ó`, -amt);
    }

    function add(amt) {
      if (amt <= 0 || isNaN(amt)) return;
      balance += amt;
      updateBalance();
      log(`‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏á‡∏¥‡∏ô ${amt} ‡∏ö‡∏≤‡∏ó`, amt);
    }

    function spendCustom() {
      const amt = parseFloat(document.getElementById('customAmount').value);
      if (isNaN(amt) || amt <= 0) return alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á');
      spend(amt);
      document.getElementById('customAmount').value = '';
    }

    function addCustom() {
      const amt = parseFloat(document.getElementById('customAmount').value);
      if (isNaN(amt) || amt <= 0) return alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á');
      add(amt);
      document.getElementById('customAmount').value = '';
    }

    function resetBalance() {
      const newBalance = prompt('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÉ‡∏´‡∏°‡πà (‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏ß‡πâ‡∏ô‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ 1000):');
      if (newBalance === null) return;
      const value = parseFloat(newBalance);
      balance = (!isNaN(value) && value > 0) ? value : 1000;
      logData = [];
      updateBalance();
      renderLogs();
      saveData();
    }

    function exportData() {
      const data = {
        balance: balance,
        logs: logData
      };
      const blob = new Blob([JSON.stringify(data, null, 2)], {type: "application/json"});
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "money-backup.json";
      a.click();
      URL.revokeObjectURL(url);
    }

    function importData() {
      const input = document.getElementById("fileInput");
      input.onchange = () => {
        const file = input.files[0];
        if (!file) return;
        const reader = new FileReader();
        reader.onload = e => {
          try {
            const data = JSON.parse(e.target.result);
            if (typeof data.balance === "number" && Array.isArray(data.logs)) {
              balance = data.balance;
              logData = data.logs;
              updateBalance();
              renderLogs();
              saveData();
              alert("‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!");
            } else {
              alert("‡πÑ‡∏ü‡∏•‡πå‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á");
            }
          } catch {
            alert("‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå‡πÑ‡∏î‡πâ");
          }
        };
        reader.readAsText(file);
      };
      input.click();
    }

    updateBalance();
    renderLogs();
  </script>
</body>

</html>
